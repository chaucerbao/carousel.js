!function(t,i){if("function"==typeof define&&define.amd)define(["module","exports"],i);else if("undefined"!=typeof exports)i(module,exports);else{var e={exports:{}};i(e,e.exports),t.Carousel=e.exports}}(this,function(t,i){"use strict";function e(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var n=function(){function t(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(i,e,n){return e&&t(i.prototype,e),n&&t(i,n),i}}(),s=function(){function t(i){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e(this,t);var s=document.querySelector(i),o=Object.assign({autoPlay:!1,delay:4e3,duration:400,infinite:!1,rewind:!1,showControls:!0,showDots:!0,onSlide:function(){return!0}},n);return Object.assign(this,this.scaffold(s,o),{options:o,slideIndex:0,xPosition:0,touchStartX:null,touchMoveX:null,slideWidth:null,slideShowHandler:null,isSlideShowActive:!1,isTransitioning:!1}),this.goTo(this.slideIndex,!0),o.autoPlay&&this.play(),{goTo:this.goTo.bind(this),next:this.next.bind(this),previous:this.previous.bind(this),play:this.play.bind(this),pause:this.pause.bind(this)}}return n(t,[{key:"scaffold",value:function(t,i){var e=this,n=this.createDomElement;t.classList.add("carousel");for(var s=[];t.firstElementChild;){var o=n("div","carousel__slide");o.appendChild(t.firstElementChild),s.push(o)}s.map(function(t){return t.style.width="calc(100% / "+s.length+")"});var a=n("div","carousel__slides");if(s.map(function(t){return a.appendChild(t)}),a.style.width=100*s.length+"%",a.addEventListener("touchstart",this.touchStart.bind(this)),a.addEventListener("touchmove",this.touchMove.bind(this)),a.addEventListener("touchend",this.touchEnd.bind(this)),a.addEventListener("transitionend",this.transitionEnd.bind(this,i)),this.enableSlideAnimation(a,i),i.infinite){var l=s[0].cloneNode(!0);l.classList.add("carousel__slide--clone"),l.style.left="100%",a.appendChild(l);var r=s[s.length-1].cloneNode(!0);r.classList.add("carousel__slide--clone"),r.style.right="100%",a.insertBefore(r,s[0])}var d=n("div","carousel__controls"),h=n("div",["carousel__control","carousel__previous"]),u=n("div",["carousel__control","carousel__next"]);h.addEventListener("click",this.previous.bind(this)),u.addEventListener("click",this.next.bind(this)),d.appendChild(h),d.appendChild(u);var c=[],v=n("div","carousel__dots");return s.map(function(t,i){var s=n("div","carousel__dot");s.addEventListener("click",e.goTo.bind(e,i,!0)),v.appendChild(s),c.push(s)}),t.appendChild(a),i.showControls&&t.appendChild(d),i.showDots&&t.appendChild(v),{slidesElement:a,slides:s,dots:c}}},{key:"goTo",value:function(t){var i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.isTransitioning)return!1;this.isTransitioning=!0;var e=this.slideIndex,n=this.slidesElement,s=this.slides,o=this.dots,a=this.options,l=a.infinite,r=a.rewind,d=s.length,h=(d+t)%d,u=0,c=d-1,v=e===u,f=e===c,p=h===u,m=h===c,g=-s[h].offsetLeft;if(!i){if(a.onSlide(h,e)===!1)return this.isTransitioning=!1,!1;if(l)v&&m&&t<0?g=s[u].getBoundingClientRect().width:f&&p&&t>=d&&(g=-n.getBoundingClientRect().width);else if(!r&&(f&&p||v&&m))return this.isTransitioning=!1,!1}a.showDots&&(o[e].classList.remove("carousel__dot--active"),o[h].classList.add("carousel__dot--active")),this.moveX(g),this.xPosition=g,this.slideIndex=h,this.isSlideShowActive&&(this.pause(),this.play()),h===e&&(this.isTransitioning=!1)}},{key:"previous",value:function(){this.goTo(this.slideIndex-1)}},{key:"next",value:function(){this.goTo(this.slideIndex+1)}},{key:"play",value:function(){this.isSlideShowActive=!0,this.slideShowHandler=setInterval(this.next.bind(this),this.options.delay)}},{key:"pause",value:function(){clearInterval(this.slideShowHandler),this.isSlideShowActive=!1}},{key:"enableSlideAnimation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.slidesElement,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options;return Object.assign(t.style,{transitionProperty:"transform",transitionDuration:i.duration/1e3+"s"})}},{key:"disableSlideAnimation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.slidesElement;return this.isTransitioning=!1,Object.assign(t.style,{transitionProperty:"initial",transitionDuration:"initial"})}},{key:"moveX",value:function(t){var i=this.slidesElement;i.style.transform="translateX(calc(100% * "+t+" / "+i.getBoundingClientRect().width+"))"}},{key:"touchStart",value:function(t){return!this.isTransitioning&&(this.isSlideShowActive&&clearInterval(this.slideShowHandler),this.touchStartX=t.touches[0].pageX,this.slideWidth=this.slides[0].getBoundingClientRect().width,void this.disableSlideAnimation())}},{key:"touchMove",value:function(t){return!!this.touchStartX&&(t.preventDefault(),this.touchMoveX=t.touches[0].pageX,void this.trackTouchMovement())}},{key:"touchEnd",value:function(t){if(this.enableSlideAnimation(),!this.touchMoveX)return!1;var i=this.slideIndex,e=this.slideWidth,n=this.touchStartX,s=this.touchMoveX,o=n-s,a=e/4;this.touchStartX=null,this.touchMoveX=null,this.slideWidth=null,Math.abs(o)>a?o<0?this.goTo(i-1):this.goTo(i+1):this.goTo(i)}},{key:"trackTouchMovement",value:function(){var t=this.touchStartX,i=this.touchMoveX,e=this.xPosition,n=this.slideWidth,s=this.slides,o=this.options;if(!i)return!1;var a=window,l=a.requestAnimationFrame,r=n-1e-4,d=Math.max(Math.min(t-i,r),-r),h=e-d;o.infinite||(h=Math.max(Math.min(h,0),-s[s.length-1].offsetLeft)),this.moveX(h),l(this.trackTouchMovement.bind(this))}},{key:"transitionEnd",value:function(t,i){var e=this;if("transform"!==i.propertyName)return!1;if(t.infinite){var n=this.slideIndex,s=this.slides,o=-s[n].offsetLeft;this.disableSlideAnimation(),this.moveX(o),setTimeout(function(){return e.enableSlideAnimation()},1),this.xPosition=o}this.isTransitioning=!1}},{key:"createDomElement",value:function(t,i){var e=document.createElement(t);return e.classList.add.apply(e.classList,Array.isArray(i)?i:[i]),e}}]),t}();i.default=s,t.exports=i.default});