!function(i,t){if("function"==typeof define&&define.amd)define(["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var e={exports:{}};t(e,e.exports),i.Carousel=e.exports}}(this,function(i,t){"use strict";function e(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function i(i,t){for(var e=0;e<t.length;e++){var s=t[e];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(i,s.key,s)}}return function(t,e,s){return e&&i(t.prototype,e),s&&i(t,s),t}}(),n=function(){function i(t){var s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e(this,i);var n=document.querySelector(t),o=Object.assign({autoPlay:!1,delay:4e3,duration:400,infinite:!1,rewind:!1,showControls:!0,showDots:!0,onSlide:function(){return!0}},s);return Object.assign(this,this.scaffold(n,o),{options:o,slideIndex:0,xPosition:0,touchStartX:null,touchMoveX:null,slideWidth:null,slideShowHandler:null,isSlideShowActive:!1,isTransitioning:!1}),this.goTo(this.slideIndex,!0),o.autoPlay&&this.play(),{goTo:this.goTo.bind(this),next:this.next.bind(this),previous:this.previous.bind(this),play:this.play.bind(this),pause:this.pause.bind(this)}}return s(i,[{key:"scaffold",value:function(i,t){var e=this,s=this.createDomElement;i.classList.add("carousel");for(var n=[];i.firstElementChild;){var o=s("div","carousel__slide");o.appendChild(i.firstElementChild),n.push(o)}n.map(function(i){return i.style.width="calc(100% / "+n.length+")"});var a=s("div","carousel__slides");if(n.map(function(i){return a.appendChild(i)}),a.style.width=100*n.length+"%",a.addEventListener("touchstart",this.touchStart.bind(this)),a.addEventListener("touchmove",this.touchMove.bind(this)),a.addEventListener("touchend",this.touchEnd.bind(this)),a.addEventListener("transitionend",this.transitionEnd.bind(this,t)),this.enableSlideAnimation(a,t),t.infinite){var l=n[0].cloneNode(!0);l.classList.add("carousel__slide--clone"),l.style.left="100%",a.appendChild(l);var r=n[n.length-1].cloneNode(!0);r.classList.add("carousel__slide--clone"),r.style.right="100%",a.insertBefore(r,n[0])}var h=s("div","carousel__controls"),d=s("div",["carousel__control","carousel__previous"]),u=s("div",["carousel__control","carousel__next"]);d.addEventListener("click",this.previous.bind(this)),u.addEventListener("click",this.next.bind(this)),h.appendChild(d),h.appendChild(u);var c=[],v=s("div","carousel__dots");return n.map(function(i,t){var n=s("div","carousel__dot");n.addEventListener("click",e.goTo.bind(e,t,!0)),v.appendChild(n),c.push(n)}),i.appendChild(a),t.showControls&&i.appendChild(h),t.showDots&&i.appendChild(v),{slidesElement:a,slides:n,dots:c}}},{key:"goTo",value:function(i){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.isTransitioning)return!1;this.isTransitioning=!0,this.measureSlide();var e=this.slideIndex,s=this.slides,n=this.slideWidth,o=this.dots,a=this.options,l=a.infinite,r=a.rewind,h=s.length,d=(h+i)%h,u=0,c=h-1,v=e===u,f=e===c,p=d===u,m=d===c,y=d*-n;if(!t){if(a.onSlide(d,e)===!1||!r&&!l&&(f&&p||v&&m))return this.isTransitioning=!1,!1;l&&(v&&m&&i<0?y=n:f&&p&&i>=h&&(y=h*-n))}this.moveX(y),d*-n===y&&(this.isTransitioning=!1),a.showDots&&(o[e].classList.remove("carousel__dot--active"),o[d].classList.add("carousel__dot--active")),this.isSlideShowActive&&(this.pause(),this.play()),this.xPosition=y,this.slideIndex=d}},{key:"previous",value:function(){this.goTo(this.slideIndex-1)}},{key:"next",value:function(){this.goTo(this.slideIndex+1)}},{key:"play",value:function(){this.isSlideShowActive=!0,this.slideShowHandler=setInterval(this.next.bind(this),this.options.delay)}},{key:"pause",value:function(){clearInterval(this.slideShowHandler),this.isSlideShowActive=!1}},{key:"enableSlideAnimation",value:function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.slidesElement,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options;return Object.assign(i.style,{transitionProperty:"transform",transitionDuration:t.duration/1e3+"s"})}},{key:"disableSlideAnimation",value:function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.slidesElement;return this.isTransitioning=!1,Object.assign(i.style,{transitionProperty:"initial",transitionDuration:"initial"})}},{key:"moveX",value:function(i){var t=this.slides,e=this.slideWidth;this.slidesElement.style.transform="translateX(calc(100% * "+i+" / "+t.length*e+"))"}},{key:"touchStart",value:function(i){return!this.isTransitioning&&(this.isSlideShowActive&&clearInterval(this.slideShowHandler),this.touchStartX=i.touches[0].pageX,this.measureSlide(),void this.disableSlideAnimation())}},{key:"touchMove",value:function(i){return!!this.touchStartX&&(this.touchMoveX=i.touches[0].pageX,this.trackTouchMovement(),void(Math.abs(this.touchStartX-this.touchMoveX)>50&&i.preventDefault()))}},{key:"touchEnd",value:function(i){if(this.enableSlideAnimation(),!this.touchMoveX)return!1;var t=this.slideIndex,e=this.slideWidth,s=this.touchStartX,n=this.touchMoveX,o=s-n,a=e/4;Math.abs(o)>a?o<0?this.goTo(t-1):this.goTo(t+1):this.goTo(t),this.touchStartX=null,this.touchMoveX=null}},{key:"trackTouchMovement",value:function(){var i=this.touchStartX,t=this.touchMoveX,e=this.xPosition,s=this.slideWidth,n=this.slides,o=this.options;if(!t)return!1;var a=window,l=a.requestAnimationFrame,r=Math.max(Math.min(i-t,s),-s),h=e-r;o.infinite||(h=Math.max(Math.min(h,0),(n.length-1)*-s)),this.moveX(h),l(this.trackTouchMovement.bind(this))}},{key:"transitionEnd",value:function(i,t){var e=this;if("transform"!==t.propertyName)return!1;if(i.infinite){var s=this.slideIndex,n=this.slideWidth,o=s*-n;this.disableSlideAnimation(),this.moveX(o),setTimeout(function(){return e.enableSlideAnimation()},1),this.xPosition=o}this.isTransitioning=!1}},{key:"createDomElement",value:function(i,t){var e=document.createElement(i);return e.classList.add.apply(e.classList,Array.isArray(t)?t:[t]),e}},{key:"measureSlide",value:function(){this.slideWidth=this.slides[0].getBoundingClientRect().width}}]),i}();t.default=n,i.exports=t.default});